[PLATFORMS]
ALL


[COMPUTESHADER]

#include <Shaders/Common/Common.h>
#include <Shaders/Common/GlobalConstants.h>

Texture2D InputTexture;
RWTexture2D<float4> Output;

static const float Offset = 0.5f / 255.0f;

[numthreads(THREAD_GROUP_COUNT_X, THREAD_GROUP_COUNT_Y, 1)]
void main(uint3 threadId : SV_DispatchThreadID)
{
  // Out of bounds check
  if (any(int2(threadId.xy) >= TargetViewportSize.xy))
    return;

  float4 color = InputTexture[threadId.xy];
  float rnd    = dither(threadId.xy * TargetViewportSize.xy).x;

  Output[threadId.xy] = color + lerp(-Offset, Offset, rnd);
}
